<!-- Using a 3rd party library for the components -->
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/thomas-lowry/figma-plugin-ds/dist/figma-plugin-ds.css"
/>

<!-- Styling -->
<style>
  div {
    margin: 10px;
    align-items: left;
    /* padding-top: 8px; */
  }
  .section-title{
    font-size: 16px;
    font-weight: semi-bold;
    color: #202223;
  }

  .primary-button {
    background-color: rgba(44, 110, 203, 1);
    cursor: pointer;
  }
  .primary-button:hover {
    background-color: rgba(31, 81, 153, 1);
  }

  .secondary-button {
    background-color: rgba(255, 255, 255, 1);
    cursor: pointer;
  }
  .secondary-button:hover {
    background-color: rgba(246, 246, 247, 1);
  }
  a {
  text-decoration: none;
}

  label {
    font-size: 12px;
    font-weight: semi-bold;
    color: #202223;
  }
  #display-theme {
    font-size: 12px;
    font-weight: regular;
    padding: 2px;
    border-radius: 2px;
    border: 1px solid #e4e8eb;
    text-align: center;
    cursor: pointer;
;
  }
  #display-theme:hover {
    background-color: rgba(246, 246, 247, 1);
;
  }
  #display-filename {
    font-size: 12px;
    font-weight: regular;
    padding: 2px;
    border-radius: 2px;
    border: 1px solid #e4e8eb;
    text-align: center;
    cursor: pointer;
  }
  #display-filename:hover {
    background-color: rgba(246, 246, 247, 1);
  }
  .instructions {
    font-size: 12px;
    font-weight: medium;
    line-height: 180%;
    text-align: left;
    /* padding-left: 1px; */
  }
</style>

<!-- UI 1/3 -->

<div id="step-1">
  <!-- Themes menu -->
  <!-- Section title -->
  <div style="margin-left: 0;" class="section-title">Select theme</div>
  <label for="theme" style="margin-left: 10px">Theme</label>
  <select id="theme" class="select-menu">
    <option>Please make a selection</option>
    <option value="Accessibility and Inclusion">
      Accessibility and Inclusion
    </option>
    <option value="Onboarding">Onboarding</option>
    <option value="Dashboard and Navigation">Dashboard and Navigation</option>
    <option value="Moving Money">Moving Money</option>
    <option value="Cards and wallets">Cards and wallets</option>
    <option value="Choosing and setting up products">
      Choosing and setting up products
    </option>
    <option value="View and use banking products">
      View and use banking products
    </option>
    <option value="Messaging and Alerts">Messaging and Alerts</option>
    <option value="Security and Access">Security and Access</option>
    <option value="Open Banking">Open Banking</option>
    <option value="Customer Information">Customer Information</option>
  </select>

  <!-- name -->
  <div style="margin-left: 0;" class="section-title">Enter filename and ticket number</div>
  <div class="input">
    <label for="filename" style="display: block; padding-bottom: 8px"
      >Filename*</label
    >
    <input
      id="filename"
      type="input"
      class="input__field"
      placeholder="Payments"
    />
  </div>

  <div class="input">
    <label for="jiraNumber" style="display: block; padding-bottom: 8px"
      >Jira number (optional)</label
    >
    <input
      id="number"
      type="input"
      class="input__field"
      style="width: 50%"
      placeholder="DT-1000"
    />
  </div>

  <!-- Submits the form -->
  <div
    style="
      display: flex;
      float: right;
      position: fixed;
      bottom: 0;
      right: 0;
      padding-bottom: 8px;
    "
  >
  <a href="https://zeroheight.com/" target="_blank"><button class="button button--secondary secondary-button">Help</button></a>
    <!--Next button-->
    <button
      id="generate"
      class="button button--primary primary-button"
      style="margin-left: 10px; float: right"
    >
      Next
    </button>
  </div>
</div>
<!-- UI 2/3 Move theme -->
<div id="step-2" style="display: none">
  <!-- Theme -->
  <div style="margin-left: 0;" class="section-title">Move file to correct theme</div>
  <label style="margin-left: 10px">Theme</label>
  <!-- Display the theme value -->

  <div id="display-theme">
    <div id="theme-value"></div>
  </div>
  <div class="instructions">
    <p>
      1. Copy the theme name above </br> 
      2. Click the down arrow at the top of the screen</br> 
      3. "move to project..."</br> 
4. Search for the theme and move it</br> 
5. Once moved, click "Next"
    </p>
  </div>

  <!-- Submits the form -->
  <div
    style="
      display: flex;
      float: right;
      position: fixed;
      bottom: 0;
      right: 0;
      padding-bottom: 8px;
    "
  >
  <a href="https://zeroheight.com/" target="_blank"><button class="button button--secondary secondary-button">Help</button></a>
    <!--Next button-->
    <button
      id="next-button-2"
      class="button button--primary primary-button"
      style="margin-left: 10px; float: right"
    >
      Next
    </button>
  </div>
</div>
<!-- UI 3/3 Rename file -->
<div id="step-3" style="display: none;"">
  <div style="margin-left: 0;" class="section-title">Rename your file</div>
  <!-- Theme -->
  <label style="margin-left: 10px">Filename</label>
  <!-- Display the theme value -->

  <div id="display-filename">
    <div id="filename-value"></div>
  </div>
  <div class="instructions">
    <p>
1. Copy the filename from above</br> 
2. Click the down arrow at the top of the file</br> 
3. Click ‚ÄúRename‚Äù</br> 
4. Paste (CTRL + V) filename</br> 
5. Enter to save</br> 
Great job, your all done üéâ</br> 
You can close this window.
    </p>
  </div>

  <!-- Submits the form -->
  <div
    style="
      display: flex;
      float: right;
      position: fixed;
      bottom: 0;
      right: 0;
      padding-bottom: 8px;
    "
  >
  <a href="https://zeroheight.com/" target="_blank"><button class="button button--secondary secondary-button">Help</button></a>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/gh/thomas-lowry/figma-plugin-ds/dist/iife/figma-plugin-ds.js"></script>
<script>
  selectMenu.init(); //initiates the select menu component
  disclosure.init(); //initiates the disclosure component

  document.getElementById("theme-value").onclick = function () {
    // create a temporary input element
    let input = document.createElement("input");
    // get the value of the theme-value element
    let value = document.getElementById("theme-value").innerHTML;
    // set the value of the input element to the value of the theme-value element
    input.setAttribute("value", value);
    // append the input element to the body
    document.body.appendChild(input);
    // select the input element
    input.select();
    // copy the selected text to the clipboard
    document.execCommand("copy");
    // remove the input element from the body
    document.body.removeChild(input);
    // show a message to the user
    alert("Copied to clipboard: " + value);
  };
  document.getElementById("next-button-2").onclick = function (event) {
  // get the number and filename values
  const number = document.getElementById("number").value;
  const filename = document.getElementById("filename").value;
  document.getElementById("step-2").style.display = "none";
  // set the innerHTML of the theme-value element to the number + filename value or just the filename if the number does not exist
  document.getElementById("filename-value").innerHTML = number ? `${number} ${filename}` : filename;
  
  // show the third step
  document.getElementById("step-3").style.display = "block";
};
document.getElementById("filename-value").onclick = function () {
  // create a temporary input element
  let input = document.createElement("input");
  // get the value of the filename-value element
  let value = document.getElementById("filename-value").innerHTML;
  // set the value of the input element to the value of the filename-value element
  input.setAttribute("value", value);
  // append the input element to the body
  document.body.appendChild(input);
  // select the input element
  input.select();
  // copy the selected text to the clipboard
  document.execCommand("copy");
  // remove the input element from the body
  document.body.removeChild(input);
  // show a message to the user
  alert("Copied to clipboard: " + value);
};

  document.getElementById("generate").onclick = function (event) {
    const inputValue = document.getElementById("filename").value;
    if (inputValue === "") {
      event.preventDefault();
      alert("Please enter a Filename");
    } else {
      const theme = document.getElementById("theme").value;
      const filename = document.getElementById("filename").value;
      const number = document.getElementById("number").value;

      // set the innerHTML of the theme-value span element to the selected theme value
      document.getElementById("theme-value").innerHTML = theme;
      // hide the first step
      document.getElementById("step-1").style.display = "none";
      // show the second step
      document.getElementById("step-2").style.display = "block";

      // Send the data to the backend
      parent.postMessage({ pluginMessage: { theme, filename, number } }, "*");
    }
  };
</script>
